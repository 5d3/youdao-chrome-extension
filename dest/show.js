function closeYoudao(){var e=document.getElementById("youdao");e&&document.body.removeChild(e);var t=document.getElementById("youdao-btn");t&&(t.style.display="none")}function initPanel(){var e=document.createElement("div");e.setAttribute("id","youdao");var t=document.createElement("p");return t.innerHTML="查询中，请稍候...",t.setAttribute("id","youdao-loading"),e.appendChild(t),document.body.appendChild(e),e}function loadYoudao(){closeYoudao();var e=initPanel(),t=function(e,t,n){e.appendChild(t).appendChild(n)},n=new XMLHttpRequest;n.open("POST","https://fanyi.youdao.com/translate?smartresult=dict&smartresult=rule&smartresult=ugc&sessionFrom=null",!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.send("type=AUTO&i="+gb.searchTxt+"&doctype=json&xmlVersion=1.8&keyfrom=fanyi.web&ue=UTF-8&action=FY_BY_ENTER&typoResult=true"),n.onreadystatechange=function(){if(4===n.readyState&&200===n.status){var o=document.getElementById("youdao-loading");o&&e.removeChild(o);var a,d,r=JSON.parse(n.responseText),u=r.translateResult[0][0],l=u.src,i=u.tgt,c=document.createElement("ul"),s=document.createElement("h2");h2Txt=document.createTextNode(l),t(e,s,h2Txt),a=document.createElement("li"),d=document.createTextNode(i),t(c,a,d);var m=r.smartResult;if(m)for(var p=m.entries,y=1;y<p.length;y++)a=document.createElement("li"),d=document.createTextNode(p[y]),t(c,a,d);e.appendChild(c)}}}var gb={searchTxt:null,enableSwitch:!0};document.onmouseup=function(e){return e.target===document.getElementById("youdao-btn")?void loadYoudao():void chrome.storage.sync.get("enableSwitch",function(e){if(e.enableSwitch){var t=window.getSelection(),n=t.getRangeAt(0).getBoundingClientRect(),o=document.getElementById("youdao-btn");o?o.style.display="block":(o=document.createElement("img"),o.setAttribute("id","youdao-btn"),o.setAttribute("src","https://raw.githubusercontent.com/Ovilia/handian-chrome-extension/master/res/handian32.png"),o.style.position="absolute",o.style.cursor="pointer",o.style.zIndex="1000",document.body.appendChild(o)),o.style.top=n.bottom+window.pageYOffset+10+"px",o.style.left=n.left+window.pageXOffset+"px";var a=t.toString();a?gb.searchTxt=a:closeYoudao()}else closeYoudao()})};